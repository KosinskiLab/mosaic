
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Influenza A Virus &#8212; mosaic 1.1.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/general.css?v=63b7f29f" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/@mdi/font@7.3.67/css/materialdesig-nicons.min.css" />
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/@phosphor-icons/web@2.1.1/src/regular/style.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=58fbf978"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=4ea706d9"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorial/workflows/iav';</script>
    <link rel="icon" href="../../_static/logo.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Batch Processing" href="pipeline.html" />
    <link rel="prev" title="Working with in situ data" href="giardia.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">mosaic</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../genindex.html">
    Index
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/KosinskiLab/mosaic" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../genindex.html">
    Index
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/KosinskiLab/mosaic" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts.html">Concepts</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Working with Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../data/import_export.html">Import and Export</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data/sessions.html">Session Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data/special.html">Specialized Views</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Feature Tabs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tabs/segmentation.html">Segmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tabs/parametrization.html">Parametrization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tabs/intelligence.html">Intelligence</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practical Workflows</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="giardia.html">Working with <em>in situ</em> data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Influenza A Virus</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipeline.html">Batch Processing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../reference/formats.html">File Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/issues.html">Issues</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Further Information</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../misc/license.html">License</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Influenza A Virus</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="influenza-a-virus">
<h1>Influenza A Virus<a class="headerlink" href="#influenza-a-virus" title="Link to this heading">#</a></h1>
<p>This tutorial guides you through analyzing Influenza A Virus (IAV) virus-like particles (VLPs) using Mosaic, taking you from initial segmentation to creating coarse-grained Martini models.</p>
<figure class="align-center" id="id24">
<a class="reference internal image-reference" href="../../_images/mosaic_workflow.png"><img alt="../../_images/mosaic_workflow.png" src="../../_images/mosaic_workflow.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Coming up</span><a class="headerlink" href="#id24" title="Link to this image">#</a></p>
</figcaption>
</figure>
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Link to this heading">#</a></h2>
<p>First, install Mosaic according to the <a class="reference internal" href="../installation.html"><span class="doc">installation instructions</span></a>. For HMFF functionality, install the additional requirements listed in <a class="reference internal" href="../installation.html#installation-dts"><span class="std std-ref">DTS Simulations</span></a>. If you plan to backmap DTS models to coarse-grained representations, install the tools listed in the <a class="reference internal" href="../installation.html#installation-backmapping"><span class="std std-ref">DTS Backmapping</span></a> section.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Membrane segmentation, template-matching and the equilibration of coarse-grained model equilibration require a GPU to complete in reasonable time. You can download intermediate results of compute-intensive task and additional material from <a class="reference external" href="https://oc.embl.de/index.php/s/URqaMtuk0OWPKEi">ownCloud</a>.</p>
</div>
<p>We’ll use publicly available cryo-ET data of an IAV VLP <a class="footnote-reference brackets" href="#id16" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, which you can download from <a class="reference external" href="https://www.ebi.ac.uk/emdb/EMD-11075">EMDB-11075</a> or via command line</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://ftp.ebi.ac.uk/pub/databases/emdb/structures/EMD-11075/map/emd_11075.map.gz
gunzip<span class="w"> </span>emd_11075.map.gz<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mv<span class="w"> </span>emd_11075.map<span class="w"> </span>emd_11075.mrc
</pre></div>
</div>
<p>For membrane segmentation, download the MemBrain_seg_v10_alpha weights <a class="footnote-reference brackets" href="#id17" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> from <a class="reference external" href="https://drive.google.com/file/d/1tSQIz_UCsQZNfyHg0RxD-4meFgolszo8/view">Google Drive</a>.</p>
</section>
<section id="visual-demonstration">
<h2>Visual Demonstration<a class="headerlink" href="#visual-demonstration" title="Link to this heading">#</a></h2>
<p>The video below demonstrates the workflow from raw cryo-ET data to initial meshes, covering membrane segmentation, mesh generation, and refinement steps detailed in the following sections.</p>
<div class="video_wrapper" style="padding-bottom: 56.250000%; padding-top: 30px; position: relative; width: 100%">
<iframe allowfullscreen="true" src="https://www.youtube.com/embed/-XyxZpJQoXA" style="border: 0; height: 100%; left: 0; position: absolute; top: 0; width: 100%">
</iframe></div></section>
<section id="membrane-segmentation">
<span id="id3"></span><h2>Membrane Segmentation<a class="headerlink" href="#membrane-segmentation" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Launch Mosaic and navigate to the <strong>Intelligence</strong> tab.</p></li>
<li><p>Click on the arrow next to the <strong>Membrane</strong> button and configure:</p>
<ul class="simple">
<li><p>Click the <em>Browse</em> button to select the downloaded model ckpt file.</p></li>
<li><p>Window Size: 160</p></li>
<li><p>Clustering: Enabled</p></li>
<li><p>Augmentation: Enabled</p></li>
<li><p>Output Sampling: 12.0</p></li>
</ul>
</li>
</ol>
<ol class="arabic simple" start="5">
<li><p>Click <em>Apply</em> and select the downloaded IAV VLP tomogram.</p></li>
</ol>
<p>The status indicator will change from “Ready” to “Membrane Segmentation.” The results will automatically load into Mosaic when complete.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Membrane segmentation requires a GPU. If unavailable, download the pre-computed segmentation <a class="reference external" href="https://oc.embl.de/index.php/s/URqaMtuk0OWPKEi">emd_11075_MemBrain_seg_v10_alpha.ckpt_segmented.mrc.gz</a> and load it using File &gt; Open.</p>
</div>
</section>
<section id="mesh-creation">
<h2>Mesh Creation<a class="headerlink" href="#mesh-creation" title="Link to this heading">#</a></h2>
<section id="clean-the-segmentation">
<h3>Clean the Segmentation<a class="headerlink" href="#clean-the-segmentation" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Switch to the <strong>Segmentation</strong> tab</p></li>
<li><p>Remove clusters corresponding to small artifacts</p>
<ol class="arabic simple">
<li><p>In the <strong>Object browser</strong>, select the <em>Cluster</em> section.</p></li>
<li><p>Click the <strong>Select</strong> button from the <strong>Base operations</strong> menu, a window should open.</p></li>
<li><p>Use the slider at the bottom of the window to adjust the threshold for cluster selection. To remove small artifacts, drag the right slider to the left until only the central IAV VLP remains unselected.</p></li>
<li><p>Close the window, the selected clusters should now be highlighted in the <strong>Object browser</strong> as well in the viewer.</p></li>
<li><p>Press <strong>delete</strong> key or use <strong>Remove</strong> menu button to remove the selected clusters.</p></li>
</ol>
</li>
<li><p>Click the <strong>Select</strong> button from the <strong>Base operations</strong> menu, a window should open.</p></li>
<li><p>Use the slider at the bottom of the window to adjust the threshold for cluster selection. To remove the small artifacts, drag the right slider to the left until only the central IAV VLP remains unselected.</p></li>
<li><p>Close the window, the selected clusters should now be highlighted in the <strong>Object browser</strong> as well in the viewer.</p></li>
<li><p>Press <strong>delete</strong> key or use <strong>Remove</strong> menu button to remove the selected clusters</p></li>
<li><p>Eliminate incorrectly segmented voxels using manual selection</p>
<ol class="arabic simple">
<li><p>Press <strong>r</strong> key - the mouse cursor should change to a crosshair</p></li>
<li><p>Click and drag to select the incorrectly segmented voxels at one end of the IAV VLP near the VLP end at the edge of the tomogram.</p></li>
<li><p>Press <strong>delete</strong> key or use <strong>Remove</strong> menu button to remove the selected voxels</p></li>
</ol>
</li>
<li><p>Thin the segmentation.</p>
<ol class="arabic simple">
<li><p>Select the central IAV VLP in the Object Browser.</p></li>
<li><p>In the <strong>Segmentation</strong> tab, click the arrow next to the <strong>Thin</strong> button.</p></li>
<li><p>Choose the <em>outer</em> option to extract the outer segmentation layer.</p></li>
<li><p>Click <strong>Apply</strong> to apply the operation. A new object will appear in the <em>Model</em> section of the <em>Object Browser</em>.</p></li>
<li><p>Righ click on the previous object and click hide to clearly see the result of the thinning operation.</p></li>
</ol>
</li>
</ol>
<div class="before-after-container" style="display: flex; gap: 10px;">
  <div style="flex: 1;">
    <img src="../../_static/tutorial/iav_workflow/segmentation_raw.png" style="width: 100%;">
   <p style="color: #707070">Before segmentation cleanup</p>
  </div>
  <div style="flex: 1;">
    <img src="../../_static/tutorial/iav_workflow/segmentation_clean.png" style="width: 100%;">
      <p style="color: #707070">After segmentation cleanup</p>
  </div>
</div></section>
<section id="generate-initial-mesh">
<h3>Generate Initial Mesh<a class="headerlink" href="#generate-initial-mesh" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Switch to the <strong>Parametrization</strong> tab.</p></li>
<li><p>Select the cleaned segmentation in the <em>Cluster</em> section of the <em>Object Browser</em>.</p></li>
<li><p>Click on the arrow next to the <strong>Mesh</strong> buton and configure:</p>
<ul class="simple">
<li><p>Method: Ball Pivoting</p></li>
<li><p>Elastic Weight: 1.0</p></li>
<li><p>Curvature Weight: 10.0</p></li>
<li><p>Volume Weight: 0.0</p></li>
<li><p>Boundary Ring: 0</p></li>
<li><p>Neighbors: 15</p></li>
<li><p>Radii: 60.0</p></li>
<li><p>Hole Size: -1.0</p></li>
<li><p>Downsample: True</p></li>
<li><p>Smoothing Steps: 5</p></li>
</ul>
</li>
<li><p>Click <em>Apply</em> to fit the mesh, creating a new object in the <em>Model</em> section of the <em>Object Browser</em>.</p></li>
<li><p>Right-click the new mesh object and select <strong>Representation</strong> to change its visualization to <strong>Mesh</strong> for better clarity.</p></li>
</ol>
<figure class="align-center" id="id25">
<a class="reference internal image-reference" href="../../_images/initial_mesh_5550.png"><img alt="../../_images/initial_mesh_5550.png" src="../../_images/initial_mesh_5550.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Initial mesh</span><a class="headerlink" href="#id25" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="refine-the-mesh">
<h3>Refine the Mesh<a class="headerlink" href="#refine-the-mesh" title="Link to this heading">#</a></h3>
<p>Since one cap of the IAV VLP falls outside the tomogram, and we’ll fill the mesh in that region to mitigate boundary effects in subsequent simulations:</p>
<ol class="arabic simple">
<li><p>Sample points from the created mesh.</p>
<ul class="simple">
<li><p>Select the mesh in the <em>Object Browser</em>.</p></li>
<li><p>Click on the arrow next to the <strong>Sample</strong> button and set:</p>
<ul>
<li><p>Sampling Method: Points</p></li>
<li><p>Sampling: 30000</p></li>
</ul>
</li>
<li><p>Click <em>Apply</em>.</p></li>
</ul>
</li>
</ol>
<ol class="arabic simple" start="3">
<li><p>Create a new mesh from the cleaned samples.</p>
<ul class="simple">
<li><p>Select the cleaned samples in the <em>Object Browser</em>.</p></li>
<li><p>Click the arrow next to <strong>Mesh</strong> again and configure:</p>
<ul>
<li><p>Method: Ball Pivoting</p></li>
<li><p>Elastic Weight: 1.0</p></li>
<li><p>Curvature Weight: 10.0</p></li>
<li><p>Volume Weight: 0.005</p></li>
<li><p>Boundary Ring: 0</p></li>
<li><p>Neighbors: 15</p></li>
<li><p>Radii: 60.0</p></li>
<li><p>Hole Size: -1.0</p></li>
<li><p>Downsample: True</p></li>
<li><p>Smoothing Steps: 5</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Click <em>Apply</em> to fit the mesh.</p></li>
<li><p>Right-click the new mesh object and select <strong>Representation</strong> to change its visualization to <strong>Mesh</strong> for better clarity. Hide the segmentation object to see the mesh clearly and compare it with the original mesh.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Observe the filled cap of the IAV VLP, which extends beyond the original segmentation.</p>
</div>
<div class="before-after-container" style="display: flex; gap: 10px;">
  <div style="flex: 1;">
    <img src="../../_static/tutorial/iav_workflow/segmentation_sample_0600.png" style="width: 100%;">
   <p style="color: #707070">Cleaned mesh points</p>
  </div>
  <div style="flex: 1;">
    <img src="../../_static/tutorial/iav_workflow/mesh_pressurized_0600.png" style="width: 100%;">
      <p style="color: #707070">Pressurized mesh</p>
  </div>
</div></section>
<section id="equilibrate-the-mesh">
<h3>Equilibrate the Mesh<a class="headerlink" href="#equilibrate-the-mesh" title="Link to this heading">#</a></h3>
<p>Before DTS simulation, meshes require equilibration to ensure stability and physical validity:</p>
<ol class="arabic simple">
<li><p>Select the refined mesh model from the <em>Object Browser</em></p></li>
<li><p>Navigate to the <strong>Intelligence</strong> tab and click <strong>Equilibrate</strong></p></li>
<li><p>Configure:</p>
<ul class="simple">
<li><p>Average Edge Length: 100</p></li>
<li><p>Steps: 5000</p></li>
<li><p>Other parameters at default values</p></li>
</ul>
</li>
</ol>
<p>Once complete, Mosaic will create three meshes in the target directory:</p>
<ul class="simple">
<li><p>mesh_base: the input mesh</p></li>
<li><p>mesh_remeshed: input mesh with desired edge length</p></li>
<li><p>mesh_equilibrated: the fully equilibrated mesh using Trimem <a class="footnote-reference brackets" href="#id18" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></p></li>
</ul>
<figure class="align-right" id="id26">
<a class="reference internal image-reference" href="../../_images/edge_lengths.png"><img alt="../../_images/edge_lengths.png" height="326" src="../../_images/edge_lengths.png" width="434" />
</a>
<figcaption>
<p><span class="caption-text">Comparison of edge lengths</span><a class="headerlink" href="#id26" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>To assess edge-length distribution, import the meshes into Mosaic and use the <strong>Properties</strong> button in the <strong>Segmentation</strong> tab. We typically choose the equilibrated mesh for DTS simulation due to its smoother surface and more predictable behavior.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pre-computed equilibrated meshes are available from <a class="reference external" href="https://oc.embl.de/index.php/s/URqaMtuk0OWPKEi">ownCloud</a>.</p>
</div>
</section>
</section>
<section id="hmff-simulation">
<h2>HMFF Simulation<a class="headerlink" href="#hmff-simulation" title="Link to this heading">#</a></h2>
<p>Navigate to the <strong>Intelligence</strong> tab and click <strong>Setup</strong> in the <strong>DTS Simulation</strong> section. Configure:</p>
<figure class="align-right" id="id27">
<a class="reference internal image-reference" href="../../_images/hmff_setup.png"><img alt="../../_images/hmff_setup.png" height="271" src="../../_images/hmff_setup.png" width="224" />
</a>
<figcaption>
<p><span class="caption-text">HMFF simulation setup dialog</span><a class="headerlink" href="#id27" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Mesh: Select mesh_equilibrated.q</p></li>
<li><p>Volume: Select the downloaded EMD-11075.</p></li>
<li><p>Invert Contrast: Enabled</p></li>
<li><p>HMFF weight (ξ): 5.0</p></li>
<li><p>Rigidity (κ): 25.0</p></li>
<li><p>Steps: 150000</p></li>
<li><p>Threads: 8 (or 1 for Mac unless FreeDTS is properly configured)</p></li>
<li><p>Lowpass cutoff: 50Å</p></li>
<li><p>Highpass cutoff: 900Å</p></li>
</ul>
<p>This will create a filtered density map and setup files for DTS simulation <a class="footnote-reference brackets" href="#id19" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> with HMFF. Open input.dts and set:</p>
<ul class="simple">
<li><p>AlexanderMove   = MetropolisAlgorithmOpenMP 0</p></li>
<li><p>VolumeCoupling  = SecondOrder 0.6 1000 1.1</p></li>
</ul>
<p>Run the simulation (takes less than five minutes with 8 threads):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bash<span class="w"> </span>run.sh
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Simulation outputs are available on <a class="reference external" href="https://oc.embl.de/index.php/s/URqaMtuk0OWPKEi">ownCloud</a> in hmff/TrajTSI_Done.</p>
</div>
<p>To analyze the refined mesh in Mosaic:</p>
<ol class="arabic simple">
<li><p>Click the arrow next to the <strong>Trajectory</strong> button in the <strong>Intelligence</strong> tab</p></li>
<li><p>Configure the settings to match the input.dts file:</p>
<ul class="simple">
<li><p>Scale: 0.012202743213335199</p></li>
<li><p>Offset: 21.0,6.0,16.0</p></li>
</ul>
</li>
</ol>
<p>Mosaic will load all trajectory time points. Use View &gt; Trajectory player to navigate through them. To assess the results, open the density file in View &gt; Volume Viewer and adjust contrast as needed. Compare the mesh at step 0 (left) and step 150,000 (right) to see how HMFF has refined the mesh to better match the viral membrane.</p>
<div class="before-after-container" style="display: flex; gap: 10px;">
  <div style="flex: 1;">
    <img src="../../_static/tutorial/iav_workflow/hmff_t0.png" style="width: 100%;">
   <p style="color: #707070">Initial mesh.</p>
  </div>
  <div style="flex: 1;">
    <img src="../../_static/tutorial/iav_workflow/hmff_t150.png" style="width: 100%;">
      <p style="color: #707070">HMFF-refined mesh.</p>
  </div>
</div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you notice vertices frozen in place throughout the simulation, this indicates the simulation is unable to develop them. Try increasing Min_Max_Lenghts or choose a lower edge length for equilibration to increase mesh resolution.</p>
</div>
</section>
<section id="constrained-template-matching">
<h2>Constrained Template Matching<a class="headerlink" href="#constrained-template-matching" title="Link to this heading">#</a></h2>
<section id="generate-seed-points">
<h3>Generate Seed Points<a class="headerlink" href="#generate-seed-points" title="Link to this heading">#</a></h3>
<p>To create seed points from the HMFF-refined mesh:</p>
<ol class="arabic simple">
<li><p>Select your desired time-point in the trajectory</p></li>
<li><p>Right-click the trajectory object in the <em>Object Browser</em> and select <strong>Duplicate</strong></p></li>
<li><p>Move to the <strong>Parametrization</strong> tab and configure <strong>Sample</strong>:</p>
<ul class="simple">
<li><p>Sampling Method: Distance</p></li>
<li><p>Sampling: 40</p></li>
<li><p>Offset: 100</p></li>
</ul>
</li>
</ol>
<p>This generates seed points approximately 40Å apart with a 100Å offset from the surface, which should position them near the centers of HA and NA proteins. Both can be validated using the <strong>Properties</strong> button in the <strong>Analysis</strong> section of the <strong>Segmentation</strong> tab. The offset should roughly correspond to the center of the protein-of-interest, in our case Hemagglutinin (HA) and Neuraminidase (NA).</p>
<p>Export the cluster object as a STAR file by right-clicking on it.</p>
</section>
<section id="template-matching">
<h3>Template Matching<a class="headerlink" href="#template-matching" title="Link to this heading">#</a></h3>
<p>The following outlines how to perform constrained template matching using PyTME <a class="footnote-reference brackets" href="#id20" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a>.</p>
<ol class="arabic simple">
<li><p><strong>Launch the PyTME Template Matching Dialog</strong>:</p>
<ul class="simple">
<li><p>Navigate to the <strong>Intelligence</strong> tab</p></li>
<li><p>Click on <strong>Setup</strong> in the Template Matching directive.</p></li>
</ul>
</li>
<li><p><strong>Prepare Data</strong>:
- In the “Data” tab, specify your working directory
- Set paths to the EMD-11075 tomogram and the HA/NA structures</p></li>
<li><p><strong>Prepare Templates</strong>:</p>
<ul class="simple">
<li><p>Switch to the “Preprocess” tab to configure template preparation</p></li>
<li><p>Set Lowpass to 15</p></li>
<li><p>Set Align Template Axis to z</p></li>
<li><p>Set Flip Template to checked</p></li>
</ul>
</li>
<li><p><strong>Configure Template Matching</strong>:</p>
<ul class="simple">
<li><p>In the “Matching” tab configure template matching parameters.</p></li>
<li><p>Set Angular Step to 7</p></li>
<li><p>Set Score Function to FLC</p></li>
<li><p>Set the path to the STAR file with seed points</p></li>
<li><p>Set Rotational Uncertainty to 15</p></li>
<li><p>Set Translational Uncertainty to (6,6,10) for HA and (6,6,12) for NA due to the longer stalk.</p></li>
<li><p>Set Tilt Range to 60,60 to create a wedge mask from -60 to 60 degrees.</p></li>
<li><p>Set Wedge Axes to 2, 0</p></li>
<li><p>Set Defocus to 30000</p></li>
<li><p>Set No Centering to checked</p></li>
</ul>
</li>
<li><p><strong>Set Peak Calling Parameters</strong>:</p>
<ul class="simple">
<li><p>Switch to the “Peak Calling” tab</p></li>
<li><p>Set Peak Caller PeakCallerMaximumFilter</p></li>
<li><p>Set Number of Peaks 10000</p></li>
<li><p>Set Minimum Distance 7 for HA and 10 for NA</p></li>
</ul>
</li>
<li><p><strong>Configure Compute Resources</strong>:</p>
<ul class="simple">
<li><p>In the “Compute” tab, allocate CPU cores and memory</p></li>
<li><p>Set backend cupy.</p></li>
</ul>
</li>
<li><p><strong>Execute the Workflow</strong>:</p>
<ul class="simple">
<li><p>Click “OK” to generate the template matching scripts</p></li>
<li><p>Mosaic will create and organize all necessary files in your working directory</p></li>
<li><p>Run the generated scripts to perform template matching</p></li>
</ul>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Template matching results are available from <a class="reference external" href="https://oc.embl.de/index.php/s/URqaMtuk0OWPKEi">ownCloud</a>.</p>
</div>
</section>
<section id="refine-protein-picks">
<h3>Refine Protein Picks<a class="headerlink" href="#refine-protein-picks" title="Link to this heading">#</a></h3>
<p>The template matching process generates coordinate files for HA and NA that need filtering:</p>
<ol class="arabic simple">
<li><p>Keep the top 97% of NA picks by score.</p></li>
<li><p>Visualize and manually refine the picks in Mosaic using the selection tool (or the GUI provided with PyTME).</p></li>
<li><p>Remove HA picks that are within 7 voxels of NA picks to avoid clashes.</p></li>
</ol>
<p>Example filtering scripts are available from <a class="reference external" href="https://oc.embl.de/index.php/s/URqaMtuk0OWPKEi">ownCloud</a>, namely pytme/filter.py and pytme/resolve_clash.py.</p>
</section>
</section>
<section id="coarse-grained-martini-models">
<h2>Coarse-Grained Martini Models<a class="headerlink" href="#coarse-grained-martini-models" title="Link to this heading">#</a></h2>
<section id="backmapping">
<h3>Backmapping<a class="headerlink" href="#backmapping" title="Link to this heading">#</a></h3>
<p>We can now combined HMFF-refined membrane models with experimentally determined protein positions to create coarse-grained Martini model representations of IAV VLP</p>
<ol class="arabic simple">
<li><p>In the <strong>Intelligence</strong> tab, click <strong>Backmapping</strong> and select an output directory</p></li>
<li><p>Set target edge length to 20 (corresponds to 20Å in this case) and add both NA and HA inclusions</p></li>
<li><p>Navigate to the specified directory</p></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The output directory will also contain a file <em>mesh.tsi</em>, which can be used for equilibrium DTS simulations with protein inclusions.</p>
</div>
</section>
<section id="coarse-graining">
<h3>Coarse Graining<a class="headerlink" href="#coarse-graining" title="Link to this heading">#</a></h3>
<p>Open the file <em>martinize.sh</em> and add paths to PDB files for <em>NA_STRUCTURE</em> and <em>HA_STRUCTURE</em>. Save the file and run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bash<span class="w"> </span>martinize.sh
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The principal axis of both proteins is required to align with the z-axis. This can be achieved with different tools. An example script using PyTME is available from <a class="reference external" href="https://oc.embl.de/index.php/s/URqaMtuk0OWPKEi">ownCloud</a>, namely pytme/templates/rot_structures.py.</p>
</div>
<p>Once the command above is completed, we can create a coarse-grained representation of the entire system using TS2CG <a class="footnote-reference brackets" href="#id21" id="id12" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use PLM utility to create a bilayer</span>
bash<span class="w"> </span>plm.sh

<span class="c1"># Use PCG utility to populate with lipids</span>
bash<span class="w"> </span>pcg.sh
</pre></div>
</div>
<p>This creates system.gro, which can be used for molecular dynamics simulation or visualization using e.g. Mosaic/VMD.</p>
</section>
<section id="equilibration">
<h3>Equilibration<a class="headerlink" href="#equilibration" title="Link to this heading">#</a></h3>
<p>Gromacs <a class="footnote-reference brackets" href="#id22" id="id13" role="doc-noteref"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></a> settings for Martini <a class="footnote-reference brackets" href="#id23" id="id14" role="doc-noteref"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></a> model equilibration are available from <a class="reference external" href="https://oc.embl.de/index.php/s/URqaMtuk0OWPKEi">ownCloud</a> in the ts2cg folder:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bash<span class="w"> </span>equilibrate.sh
</pre></div>
</div>
<p>This performs energy minimization which can be run on a standard laptop. The final equilibration step should be run in an HPC environment (see eq/equilibrate.sbatch for an example).</p>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>You’ve now completed the entire workflow for analyzing IAV virus-like particles—from tomogram segmentation to creating a detailed molecular model. This model can serve as a foundation for structural analysis or as a starting system for molecular simulations.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id16" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Peukes, J., Xiong, X., Erlendsson, S., Qu, K., Wan, W., Calder, L.J., Schraidt, O., Kummer, S., Freund, S.M.V., Kräusslich, H.G., Briggs, J.A.G. (2020). “The native structure of the assembled matrix protein 1 of influenza A virus”. Nature, 587, 495-498. <a class="reference external" href="https://doi.org/10.1038/s41586-020-2696-8">https://doi.org/10.1038/s41586-020-2696-8</a></p>
</aside>
<aside class="footnote brackets" id="id17" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Lamm, L., Sieber, J., Chung, J.E. et al. (2024). “MemBrain-seg: Deep learning-based segmentation of cellular membranes in cryo-electron tomography”. bioRxiv, doi.org/10.1101/2024.01.05.574336</p>
</aside>
<aside class="footnote brackets" id="id18" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">3</a><span class="fn-bracket">]</span></span>
<p>Siggel, M., Kehl, S., Reuter, K., Köfinger, J., Hummer, G. (2022). “TriMem: A parallelized hybrid Monte Carlo software for efficient simulations of lipid membranes”. Journal of Chemical Physics, 157, 174801. <a class="reference external" href="https://doi.org/10.1063/5.0101118">https://doi.org/10.1063/5.0101118</a></p>
</aside>
<aside class="footnote brackets" id="id19" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">4</a><span class="fn-bracket">]</span></span>
<p>Pezeshkian, W., Ipsen, J.H. (2024). “Mesoscale simulation of biomembranes with FreeDTS”. Nature Communications, 15, 548. <a class="reference external" href="https://doi.org/10.1038/s41467-024-44819-w">https://doi.org/10.1038/s41467-024-44819-w</a></p>
</aside>
<aside class="footnote brackets" id="id20" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">5</a><span class="fn-bracket">]</span></span>
<p>Maurer, V.J., Siggel, M., Kosinski, J. (2024). “PyTME (Python Template Matching Engine): A fast, flexible, and multi-purpose template matching library for cryogenic electron microscopy data”. SoftwareX, 25, 101636. <a class="reference external" href="https://doi.org/10.1016/j.softx.2023.101636">https://doi.org/10.1016/j.softx.2023.101636</a></p>
</aside>
<aside class="footnote brackets" id="id21" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id12">6</a><span class="fn-bracket">]</span></span>
<p>Pezeshkian, W., König, M., Wassenaar, T.A., Marrink, S.J. (2020). “Backmapping triangulated surfaces to coarse-grained membrane models”. Nature Communications, 11, 2296. <a class="reference external" href="https://doi.org/10.1038/s41467-020-16094-y">https://doi.org/10.1038/s41467-020-16094-y</a></p>
</aside>
<aside class="footnote brackets" id="id22" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id13">7</a><span class="fn-bracket">]</span></span>
<p>Abraham, M.J., Murtola, T., Schulz, R., Páll, S., Smith, J.C., Hess, B., Lindahl, E. (2015). “GROMACS: High performance molecular simulations through multi-level parallelism from laptops to supercomputers”. SoftwareX, 1-2, 19-25. <a class="reference external" href="https://doi.org/10.1016/j.softx.2015.06.001">https://doi.org/10.1016/j.softx.2015.06.001</a></p>
</aside>
<aside class="footnote brackets" id="id23" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id14">8</a><span class="fn-bracket">]</span></span>
<p>Souza, P.C.T., Alessandri, R., Barnoud, J., Thallmair, S., Faustino, I., Grünewald, F., Patmanidis, I., Abdizadeh, H., Bruininks, B.M.H., Wassenaar, T.A., Kroon, P.C., Melcr, J., Nieto, V., Corradi, V., Khan, H.M., Domański, J., Javanainen, M., Martinez-Seara, H., Reuter, N., Best, R.B., Vattulainen, I., Monticelli, L., Periole, X., Tieleman, D.P., de Vries, A.H., Marrink, S.J. (2021). “Martini 3: a general purpose force field for coarse-grained molecular dynamics”. Nature Methods, 18, 382-388. <a class="reference external" href="https://doi.org/10.1038/s41592-021-01098-3">https://doi.org/10.1038/s41592-021-01098-3</a></p>
</aside>
</aside>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="giardia.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Working with <em>in situ</em> data</p>
      </div>
    </a>
    <a class="right-next"
       href="pipeline.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Batch Processing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#requirements">Requirements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visual-demonstration">Visual Demonstration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#membrane-segmentation">Membrane Segmentation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mesh-creation">Mesh Creation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clean-the-segmentation">Clean the Segmentation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-initial-mesh">Generate Initial Mesh</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#refine-the-mesh">Refine the Mesh</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibrate-the-mesh">Equilibrate the Mesh</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hmff-simulation">HMFF Simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constrained-template-matching">Constrained Template Matching</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-seed-points">Generate Seed Points</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#template-matching">Template Matching</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#refine-protein-picks">Refine Protein Picks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coarse-grained-martini-models">Coarse-Grained Martini Models</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#backmapping">Backmapping</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coarse-graining">Coarse Graining</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibration">Equilibration</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024-2025, European Molecular Biology Laboratory.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.0.4.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>